/* **************************************************************************
 * APLICACIÓN DE DEMO
 * ==========================================================================
 * *********************************************************************** */

 /**
 * \file
 * \brief	APLICACIÓN DE DEMOSTRACIÓN LED/TECLAS
 * \author         J.R.G
 *
 */

/* **************************************************************************
 * DECLARACIONES
 * *********************************************************************** */

#include "CORTEXM_TYPES.h"

#include "SYSTEM.h"

/* **************************************************************************
 * DEFINICIONES Y CONSTANTES
 * *********************************************************************** */


/* **************************************************************************
 * VARIABLES
 * *********************************************************************** */


/* ##########################################################################
 * ##########################################################################
 * ########        AUXILIARES        ########################################
 * ##########################################################################
 * ####################################################################### */

/* **************************************************************************
 * TEST DE PULSADORES CON LED
 * --------------------------------------------------------------------------
 * *********************************************************************** */

static void Test_SWLED(void)
{

	for(;;)
	{

		uint32_t stat1 = SWITCH_GetSW1() & SWITCH_BIT_ACTUALSTAT;
		uint32_t stat2 = SWITCH_GetSW2() & SWITCH_BIT_ACTUALSTAT;

		if( (stat1 != 0) && (stat2 != 0) )
		{
	    	LED_Set(0xFFFFFFFF);
		}
		else if (stat1 != 0)
		{
			LED_Set(0x55555555);
		}
		else if (stat2 != 0)
		{
			LED_Set(0xFF00FF00);
		}
		else
		{
			LED_Set(0x00000000);
		}
	}
}

/* **************************************************************************
 * TEST DE PULSADORES CON FLANCO LARGO Y AUTOREPETICIÓN
 * --------------------------------------------------------------------------
 * *********************************************************************** */

static void Test_SWSER(void)
{

	for(;;)
	{

		uint32_t stat1 = SWITCH_GetSW1();

		if(stat1 & SWITCH_BIT_EDGEON)
		{
			SERIE_TxChar('1');
		}
		if(stat1 & SWITCH_BIT_EDGEOFF)
		{
			SERIE_TxChar('0');
		}
		if(stat1 & SWITCH_BIT_FLAGLONGON)
		{
			SERIE_TxChar('L');
		}
		if(stat1 & SWITCH_BIT_FLAGREPEAT)
		{
			SERIE_TxChar('r');
		}
	}
}


/* ##########################################################################
 * ##########################################################################
 * ########        APLICACIÓN          ######################################
 * ##########################################################################
 * ####################################################################### */

/* **************************************************************************
 * APLICACIÓN PRINCIPAL
 * --------------------------------------------------------------------------
 ************************************************************************* */

int main(void)
{

    /* --- INICIALIZACIONES. SISTEMA ------------------------------------- */

	SYSTEM_Ini(0);

	/* --- TESTS PARA PRUEBAS -------------------------------------------- */

	for(;;)
	{
//		Test_SWLED();
		Test_SWSER();
	}

	/* --- BUCLE PRINCIPAL ----------------------------------------------- */


	/* --- NO DEBE LLEGAR AQUÍ PERO... ----------------------------------- */

	//SYSTEM_ReInit();

}


/* ##########################################################################
 * ##########################################################################
 * ####################################################################### */
